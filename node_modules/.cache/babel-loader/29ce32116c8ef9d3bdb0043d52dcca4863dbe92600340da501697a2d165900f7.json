{"ast":null,"code":"var _jsxFileName = \"/Users/chenzhe/Desktop/FoodPlanner-main/src/components/upload.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { getBase64 } from \"../helpers/imageHelper\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AiwithImage = () => {\n  _s();\n  const genAI = new GoogleGenerativeAI(\"AIzaSyAJcTSS_Ru7jk7dl03P-4e3ZVaG28bnNms\");\n  const [image, setImage] = useState(\"\");\n  const [imageInineData, setImageInlineData] = useState(\"\");\n  const [aiResponse, setResponse] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  /**\n   * Generative AI Call to fetch image insights\n   */\n  async function aiImageRun() {\n    setLoading(true);\n    setResponse(\"\");\n    const model = genAI.getGenerativeModel({\n      model: \"gemini-pro-vision\"\n    });\n    const result = await model.generateContent([\"What food are in the picture? Return a dictionary with the food name as the key, 'purchaseDate' and 'expirationDate' as values. The purchaseDate will be the current date of the picture being uploaded, for exmaple today is April 13 2024, and the expiration date will be the general expiration date of the food. For example, red peppers are in the graph, the purchase date will be April 13, 2024 and the general expiration date of red peppers is about 7 days, so the expiration date of it will be April 20,2024\", imageInineData]);\n    const response = await result.response;\n    const text = response.text();\n    setResponse(text);\n    setLoading(false);\n  }\n  const handleClick = () => {\n    aiImageRun();\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n\n    // getting base64 from file to render in DOM\n    getBase64(file).then(result => {\n      setImage(result);\n    }).catch(e => console.log(e));\n\n    // generating content model for Gemini Google AI\n    fileToGenerativePart(file).then(image => {\n      setImageInlineData(image);\n    });\n  };\n\n  // Converts a File object to a GoogleGenerativeAI.Part object.\n  async function fileToGenerativePart(file) {\n    const base64EncodedDataPromise = new Promise(resolve => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(\",\")[1]);\n      reader.readAsDataURL(file);\n    });\n    return {\n      inlineData: {\n        data: await base64EncodedDataPromise,\n        mimeType: file.type\n      }\n    };\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => handleImageChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginLeft: \"20px\"\n          },\n          onClick: () => handleClick(),\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: image,\n        style: {\n          width: \"30%\",\n          marginTop: 30\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), loading == true && aiResponse == \"\" ? /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        margin: \"30px 0\"\n      },\n      children: \"Loading ...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: \"30px 0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: aiResponse\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n_s(AiwithImage, \"9Nmx1pdeRI4NvAlzYDy6YFA6jZ8=\");\n_c = AiwithImage;\nexport default AiwithImage;\nvar _c;\n$RefreshReg$(_c, \"AiwithImage\");","map":{"version":3,"names":["React","useState","GoogleGenerativeAI","getBase64","jsxDEV","_jsxDEV","AiwithImage","_s","genAI","image","setImage","imageInineData","setImageInlineData","aiResponse","setResponse","loading","setLoading","aiImageRun","model","getGenerativeModel","result","generateContent","response","text","handleClick","handleImageChange","e","file","target","files","then","catch","console","log","fileToGenerativePart","base64EncodedDataPromise","Promise","resolve","reader","FileReader","onloadend","split","readAsDataURL","inlineData","data","mimeType","type","children","style","display","onChange","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","onClick","src","width","marginTop","margin","_c","$RefreshReg$"],"sources":["/Users/chenzhe/Desktop/FoodPlanner-main/src/components/upload.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { getBase64 } from \"../helpers/imageHelper\";\n\nconst AiwithImage = () => {\n  const genAI = new GoogleGenerativeAI(\n    \"AIzaSyAJcTSS_Ru7jk7dl03P-4e3ZVaG28bnNms\"\n  );\n\n  const [image, setImage] = useState(\"\");\n  const [imageInineData, setImageInlineData] = useState(\"\");\n  const [aiResponse, setResponse] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  /**\n   * Generative AI Call to fetch image insights\n   */\n  async function aiImageRun() {\n    setLoading(true);\n    setResponse(\"\");\n    const model = genAI.getGenerativeModel({ model: \"gemini-pro-vision\" });\n    const result = await model.generateContent([\n      \"What food are in the picture? Return a dictionary with the food name as the key, 'purchaseDate' and 'expirationDate' as values. The purchaseDate will be the current date of the picture being uploaded, for exmaple today is April 13 2024, and the expiration date will be the general expiration date of the food. For example, red peppers are in the graph, the purchase date will be April 13, 2024 and the general expiration date of red peppers is about 7 days, so the expiration date of it will be April 20,2024\",\n      imageInineData,\n    ]);\n    const response = await result.response;\n    const text = response.text();\n    setResponse(text);\n    setLoading(false);\n  }\n\n  const handleClick = () => {\n    aiImageRun();\n  };\n\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n\n    // getting base64 from file to render in DOM\n    getBase64(file)\n      .then((result) => {\n        setImage(result);\n      })\n      .catch((e) => console.log(e));\n\n    // generating content model for Gemini Google AI\n    fileToGenerativePart(file).then((image) => {\n      setImageInlineData(image);\n    });\n  };\n\n  // Converts a File object to a GoogleGenerativeAI.Part object.\n  async function fileToGenerativePart(file) {\n    const base64EncodedDataPromise = new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(\",\")[1]);\n      reader.readAsDataURL(file);\n    });\n\n    return {\n      inlineData: { data: await base64EncodedDataPromise, mimeType: file.type },\n    };\n  }\n\n  return (\n    <div>\n      <div>\n        <div style={{ display: \"flex\" }}>\n          <input type=\"file\" onChange={(e) => handleImageChange(e)} />\n          <button style={{ marginLeft: \"20px\" }} onClick={() => handleClick()}>\n            Search\n          </button>\n        </div>\n        <img src={image} style={{ width: \"30%\", marginTop: 30 }} />\n      </div>\n\n      {loading == true && aiResponse == \"\" ? (\n        <p style={{ margin: \"30px 0\" }}>Loading ...</p>\n      ) : (\n        <div style={{ margin: \"30px 0\" }}>\n          <p>{aiResponse}</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AiwithImage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}