{"ast":null,"code":"var _jsxFileName = \"/Users/y.i_2.0/Documents/course/FoodPlanner/src/components/upload.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { getBase64 } from \"../helpers/imageHelper\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AiwithImage = ({\n  start_id,\n  setfoods\n}) => {\n  _s();\n  const genAI = new GoogleGenerativeAI(\"AIzaSyAJcTSS_Ru7jk7dl03P-4e3ZVaG28bnNms\");\n  const [image, setImage] = useState(\"\");\n  const [imageInineData, setImageInlineData] = useState(\"\");\n  const [aiResponse, setResponse] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  // const start_id = foods.length;\n  // console.log(start_id);\n\n  /**\n   * Generative AI Call to fetch image insights\n   */\n  async function aiImageRun() {\n    setLoading(true);\n    setResponse(\"\");\n    const model = genAI.getGenerativeModel({\n      model: \"gemini-pro-vision\"\n    });\n    const result = await model.generateContent([`What food are in the picture? Only return a JSON array with 'id' incrementing from ${start_id} (for example, if start_id is 3, then the first id will be 4), 'name' (name of each food), 'count' (count of each food), 'purchaseDate' and 'expirationDate' as values. The purchaseDate will be the current date of the picture being uploaded in the formate of year-month-day, for exmaple today is 2024-04-13, and the expiration date will be the general expiration date of the food. For example, red peppers are in the graph, the purchase date will be April 13, 2024 and the general expiration date of red peppers is about 7 days, so the expiration date of it will be April 20,2024. Make Sure the JSON is valid.`, imageInineData]);\n    const response = await result.response;\n    const text = await response.text();\n    setfoods(foods => [...foods, ...JSON.parse(text)]);\n    setResponse(text);\n    setLoading(false);\n  }\n  const handleClick = () => {\n    aiImageRun();\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n\n    // getting base64 from file to render in DOM\n    getBase64(file).then(result => {\n      setImage(result);\n    }).catch(e => console.log(e));\n\n    // generating content model for Gemini Google AI\n    fileToGenerativePart(file).then(image => {\n      setImageInlineData(image);\n    });\n  };\n\n  // Converts a File object to a GoogleGenerativeAI.Part object.\n  async function fileToGenerativePart(file) {\n    const base64EncodedDataPromise = new Promise(resolve => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(\",\")[1]);\n      reader.readAsDataURL(file);\n    });\n    return {\n      inlineData: {\n        data: await base64EncodedDataPromise,\n        mimeType: file.type\n      }\n    };\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => handleImageChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginLeft: \"20px\"\n          },\n          onClick: () => handleClick(),\n          children: \"Search\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: image,\n        style: {\n          width: \"30%\",\n          marginTop: 30\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), loading === true && aiResponse === \"\" ? /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        margin: \"30px 0\"\n      },\n      children: \"Loading ...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: \"30px 0\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: aiResponse\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(AiwithImage, \"9Nmx1pdeRI4NvAlzYDy6YFA6jZ8=\");\n_c = AiwithImage;\nexport default AiwithImage;\nvar _c;\n$RefreshReg$(_c, \"AiwithImage\");","map":{"version":3,"names":["React","useState","GoogleGenerativeAI","getBase64","jsxDEV","_jsxDEV","AiwithImage","start_id","setfoods","_s","genAI","image","setImage","imageInineData","setImageInlineData","aiResponse","setResponse","loading","setLoading","aiImageRun","model","getGenerativeModel","result","generateContent","response","text","foods","JSON","parse","handleClick","handleImageChange","e","file","target","files","then","catch","console","log","fileToGenerativePart","base64EncodedDataPromise","Promise","resolve","reader","FileReader","onloadend","split","readAsDataURL","inlineData","data","mimeType","type","children","style","display","onChange","fileName","_jsxFileName","lineNumber","columnNumber","marginLeft","onClick","src","width","marginTop","margin","_c","$RefreshReg$"],"sources":["/Users/y.i_2.0/Documents/course/FoodPlanner/src/components/upload.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { getBase64 } from \"../helpers/imageHelper\";\n\nconst AiwithImage = ({ start_id, setfoods }) => {\n  const genAI = new GoogleGenerativeAI(\n    \"AIzaSyAJcTSS_Ru7jk7dl03P-4e3ZVaG28bnNms\"\n  );\n\n  const [image, setImage] = useState(\"\");\n  const [imageInineData, setImageInlineData] = useState(\"\");\n  const [aiResponse, setResponse] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  // const start_id = foods.length;\n  // console.log(start_id);\n\n  /**\n   * Generative AI Call to fetch image insights\n   */\n  async function aiImageRun() {\n    setLoading(true);\n    setResponse(\"\");\n    const model = genAI.getGenerativeModel({ model: \"gemini-pro-vision\" });\n    const result = await model.generateContent([\n      `What food are in the picture? Only return a JSON array with 'id' incrementing from ${start_id} (for example, if start_id is 3, then the first id will be 4), 'name' (name of each food), 'count' (count of each food), 'purchaseDate' and 'expirationDate' as values. The purchaseDate will be the current date of the picture being uploaded in the formate of year-month-day, for exmaple today is 2024-04-13, and the expiration date will be the general expiration date of the food. For example, red peppers are in the graph, the purchase date will be April 13, 2024 and the general expiration date of red peppers is about 7 days, so the expiration date of it will be April 20,2024. Make Sure the JSON is valid.`,\n      imageInineData,\n    ]);\n    const response = await result.response;\n    const text = await response.text();\n    setfoods((foods) => [...foods, ...JSON.parse(text)]);\n    setResponse(text);\n    setLoading(false);\n  }\n\n  const handleClick = () => {\n    aiImageRun();\n  };\n\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n\n    // getting base64 from file to render in DOM\n    getBase64(file)\n      .then((result) => {\n        setImage(result);\n      })\n      .catch((e) => console.log(e));\n\n    // generating content model for Gemini Google AI\n    fileToGenerativePart(file).then((image) => {\n      setImageInlineData(image);\n    });\n  };\n\n  // Converts a File object to a GoogleGenerativeAI.Part object.\n  async function fileToGenerativePart(file) {\n    const base64EncodedDataPromise = new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(\",\")[1]);\n      reader.readAsDataURL(file);\n    });\n\n    return {\n      inlineData: { data: await base64EncodedDataPromise, mimeType: file.type },\n    };\n  }\n\n  return (\n    <div>\n      <div>\n        <div style={{ display: \"flex\" }}>\n          <input type=\"file\" onChange={(e) => handleImageChange(e)} />\n          <button style={{ marginLeft: \"20px\" }} onClick={() => handleClick()}>\n            Search\n          </button>\n        </div>\n        <img src={image} style={{ width: \"30%\", marginTop: 30 }} />\n      </div>\n\n      {loading === true && aiResponse === \"\" ? (\n        <p style={{ margin: \"30px 0\" }}>Loading ...</p>\n      ) : (\n        <div style={{ margin: \"30px 0\" }}>\n          <p>{aiResponse}</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AiwithImage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}